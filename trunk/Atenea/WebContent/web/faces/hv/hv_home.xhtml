<?xml version='1.0' encoding='UTF-8' ?>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:rich="http://richfaces.org/rich"
	  xmlns:richfaces="http://richfaces.ajax4jsf.org/rich"      
	  xmlns:a4j="http://richfaces.org/a4j"
	  xmlns:c="http://java.sun.com/jstl/core">
<head>
	<link href="#{AutenticacionMB.fullContextPath}/web/estilos/inascolNuevo.css" rel="stylesheet" type="text/css" />
</head>		  
<body>
	<ui:composition template="../../template.xhtml">
		<ui:define name="cuerpo">
			<rich:panel style="width:940px;height:440px;background-image:url(#{AutenticacionMB.fullContextPath}/web/imagenes/fondopagina.png)">
				<table align="left">
					<tr>
						<td align="left"><h:outputLabel value="BÚSQUEDA DE HOJAS DE VIDA" styleClass="TituloContenido"></h:outputLabel></td>
					</tr>
				</table>
				<br/><br/><br/><br/>
				<h:form>	
				<table>
					<tr>
						<td><h:outputLabel value="Nombres y Apellidos: "></h:outputLabel></td>
						<td><h:inputText size="40" value="#{PersonaMB.nombrePersona}"></h:inputText></td>					
						<td width="100px"></td>
						<td><h:outputLabel value="Identificación : "></h:outputLabel></td>
						<td><h:inputText value="#{PersonaMB.identificacionPersona}"></h:inputText></td>
					</tr>
				</table>
				<br/>				
				<table align="right">
					<tr>
						<td><h:commandButton action="#{PersonaMB.getBusquedaBasicaPersona}" value="Buscar"/></td>
						<td width="20px"></td>
						<td><h:commandButton action="#{PersonaMB.getBusquedaAvanzada}" value="Búsqueda Avanzada"/></td>
					</tr>
				</table>
				</h:form>
				<br/><br/>
				<h:form>
				<table align="right">
					<tr>
						<td><h:commandButton action="#{PersonaMB.getAgregarHojaVida}" value="Agregar Hoja de Vida"/></td>						
					</tr>
				</table>
				</h:form>												
				<br/><br/><br/><br/>
				<h:outputLabel value="Resultados de Búsqueda" styleClass="TituloContenido"></h:outputLabel>
				<br/><br/>
				<h:form>	
				<rich:extendedDataTable id="tablaPersonas" align="center" value="#{PersonaMB.personas}" var="persona" height="200px" width="900px">
					<rich:column width="100px" label="Nombre Completo" sortable="true" sortBy="#{persona.perVnombres}">
						<f:facet name="header">
							<h:outputLabel value="Nombre Completo"></h:outputLabel>
						</f:facet>
						<a4j:commandLink id="persona" onclick="procesarSolicitudPersonaDetalle('#{persona.perNidpersona}')">
							<h:outputLabel value="#{persona.perVnombres}"></h:outputLabel>
							<br/>
							<h:outputLabel value="#{persona.perVapellidos}"></h:outputLabel>
						</a4j:commandLink>	
					</rich:column>
					<rich:column width="250px" label="Profesión" sortable="true" sortBy="#{formacion.forVtitulo}" headerClass="columna">
						<f:facet name="header">
							<h:outputLabel value="Profesión"></h:outputLabel>
						</f:facet>
						<h:dataTable value="#{persona.gppFormaciones}" var="formacion">
							<h:column>
								<h:outputLabel value="#{formacion.forVtitulo} - " rendered="#{formacion.nacNidnivelac == 3}"></h:outputLabel>
								<h:outputLabel value="(#{formacion.forDfecgrado})" rendered="#{formacion.nacNidnivelac == 3}" ></h:outputLabel>
							</h:column>
						</h:dataTable>								
					</rich:column>
					<rich:column width="120px" label="Tarjeta Profesional" sortable="true" sortBy="#{formacion.forVtarjetaprof}">
						<f:facet name="header">
							<h:outputLabel value="Tarjeta Profesional"></h:outputLabel>
						</f:facet>
						<h:dataTable value="#{persona.gppFormaciones}" var="formacion">						
							<h:column>
								<h:outputLabel value="#{formacion.forVtarjetaprof}" rendered="#{formacion.nacNidnivelac == 3}"></h:outputLabel>
							</h:column>
						</h:dataTable>
					</rich:column>					
					<rich:column width="150px" label="Conocimientos" sortable="true" sortBy="#{persona.gppPerfilprofesional.pprVperfil}">
						<f:facet name="header">
							<h:outputLabel value="Conocimientos"></h:outputLabel>
						</f:facet>
						<h:dataTable value="#{persona.gppFormaciones}" var="formacion">
							<h:column>
								<h:outputLabel value="#{formacion.forVtitulo}" rendered="#{formacion.nacNidnivelac > 3}"></h:outputLabel>
							</h:column>
						</h:dataTable>							
					</rich:column>
					<rich:column width="100px" label="Certificación" sortable="true" sortBy="#{certificacion.forVtitulo}">
						<f:facet name="header">
							<h:outputLabel value="Certificación"></h:outputLabel>
						</f:facet>
						<h:dataTable value="#{persona.gppCertificaciones}" var="certificacion">
							<h:column>
								<h:outputLabel value="#{certificacion.forVtitulo}"></h:outputLabel>
							</h:column>
						</h:dataTable>	
					</rich:column>
					<rich:column width="50px" label="Puntaje" sortable="true" sortBy="#{persona.perNpuntaje}">
						<f:facet name="header">
							<h:outputLabel value="Puntaje"></h:outputLabel>
						</f:facet>
						<h:outputLabel value="#{persona.perNpuntaje}"></h:outputLabel>
					</rich:column>										
					<rich:column width="80px" label="Modificar">
						<f:facet name="header">
							<h:outputLabel value="Modificar"></h:outputLabel>
						</f:facet>
						<a4j:commandLink id="modificar" onclick="procesarSolicitudEditarPersona('#{persona.perNidpersona}')"> 
                            <h:graphicImage align="center" url="../../imagenes/editar.png"/>
                        </a4j:commandLink>
					</rich:column>
					<rich:column width="50px" label="Activar">
						<f:facet name="header">
							<h:outputLabel value="Activar"></h:outputLabel>
						</f:facet>
						<h:selectBooleanCheckbox value="#{persona.perBactivo}" onclick="aceptar = confirm('Esta seguro que quiere cambiar el estado del elemento seleccionado?'); if(aceptar==true){procesarSolicitudEstadoPersona('#{persona.perNidpersona}','#{persona.perBactivo}');} return false;"></h:selectBooleanCheckbox>
					</rich:column>									
				</rich:extendedDataTable>
				</h:form>					
			</rich:panel>
        	<a4j:form>
	            <a4j:jsFunction name="procesarSolicitudPersonaDetalle" action="#{PersonaMB.getSeleccionarPersonaDetalle}" >
	                <a4j:actionparam name="p1" assignTo="#{PersonaMB.idPersona}" />                
            	</a4j:jsFunction>
        	</a4j:form>				
        	<a4j:form>
	            <a4j:jsFunction name="procesarSolicitudEditarPersona" action="#{PersonaMB.getSeleccionarPersona}" >
	                <a4j:actionparam name="p1" assignTo="#{PersonaMB.idPersona}" />                
            	</a4j:jsFunction>
        	</a4j:form>	
        	<a4j:form>
	            <a4j:jsFunction name="procesarSolicitudEstadoPersona" action="#{PersonaMB.getCambiarEstadoPersona}" >
	                <a4j:actionparam name="p1" assignTo="#{PersonaMB.idPersona}" />                
	                <a4j:actionparam name="p2" assignTo="#{PersonaMB.estadoPersona}" />
            	</a4j:jsFunction>
        	</a4j:form>	        								
		</ui:define>
	</ui:composition>
</body>
</html>